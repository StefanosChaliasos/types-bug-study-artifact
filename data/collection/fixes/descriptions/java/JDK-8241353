It seems that after the fix for JDK-8194901 NPE may happen if some JavaCompiler is registered in an unnamed module. 

java.lang.NullPointerException at java.compiler@11.0.4/javax.tools.ToolProvider.lambda$matches$0(ToolProvider.java:141) at java.base/java.security.AccessController.doPrivileged(Native Method) at java.compiler@11.0.4/javax.tools.ToolProvider.matches(ToolProvider.java:143) at java.compiler@11.0.4/javax.tools.ToolProvider.getSystemTool(ToolProvider.java:121) at java.compiler@11.0.4/javax.tools.ToolProvider.getSystemJavaCompiler(ToolProvider.java:61)