Suppose I reference some internal field of class (in production sources) from test sources
Frontend visibility check will pass in the IDE (because they are in the same IDEA module), but visibility check during compilation step will fail. 
Reason: There are two different module scripts for tests and for production, test sources are processed separately with the dependency on production sources compilation output.